## 라즈베리파이 OS 프로젝트 소개 또는 효율적으로 운영체제 개발을 학습하는 방법

몇 년 전, 나는 처음으로 리눅스 커널의 소스 코드를 열었습니다. 그 당시 나는 다소 능숙한 소프트웨어 개발자라고 생각했습니다. 어셈블리어와 C 프로그래밍을 조금 알고 있었고, 공정 스케줄링, 가상 메모리 관리 등 주요 운영 체제 개념에 대한 높은 수준의 이해를 가지고 있었습니다. 하지만, 나의 첫 번째 시도는 완전히 실패했습니다. 나는 거의 아무것도 이해하지 못했습니다.

내가 다뤄야 하는 다른 소프트웨어 프로젝트의 경우, 나는 보통 매우 잘 작동하는 간단한 접근방식을 가지고 있습니다. 나는 프로그램의 시작점을 찾은 다음, 내가 관심 있는 모든 세부사항을 이해하기 위해 필요한 만큼 깊이 들어가면서 소스 코드를 읽기 시작합니다. 이 접근법은 매우 좋지만 운영 체제만큼에는 그렇지 않았습니다. 단지 진입점을 찾는 데만 일주일이 넘게 걸린 것이 아니라, 중요한 문제는 내가 몇 줄의 코드를 보고 있는 상황에서 그 코드들이 무엇을 하고 있는지 어떤 단서라도 찾아낼 수 있는 방법이 없다는 것을 내 자신을 발견했다는 점이었습니다. 이것은 특히 낮은 레벨의 어셈블리어 소스 코드에 대해서는 사실이었지만, 내가 조사하려고 했던 시스템의 다른 어떤 부분에서도 더 좋을 수 없었습니다.

나는 처음부터 문제가 복잡해 보인다고 해서 그것을 무시하는 생각을 좋아하지 않습니다. 게다가 나는 복잡한 문제는 없다고 믿습니다. 대신에, 우리가 효율적으로 어떻게 해결해야 할지 모르는 많은 문제들이 있기 때문에, 나는 OS 개발을 일반적이고 특히 Linux에서 배울 수 있는 효과적인 방법을 찾기 시작했습니다.

### OS 개발 학습에서의 어려움

리눅스 커널 개발에 관한 수많은 책과 문서들이 있다는 것을 알지만, 둘 다 내가 원하는 학습 경험을 나에게 제공하지 않았습니다. 그 자료들의 절반은 너무 피상적이었고 나는 그것을 이미 알고 있었습니다. 나머지 절반은 커널 소스 코드를 탐구하는 것과 매우 유사한 문제를 가지고 있습니다. 즉, 책이 충분히 깊이 들어가자마자, 세부사항의 90%는 핵심 개념과 무관해보이고 일부 보안, 성능 또는 레거시 고려사항과 Linux 커널이 지원하는 수백만가지의 특징들과 관련있는 것으로 보입니다. 결과적으로, 핵심 운영체제 개념을 배우는 대신에 당신은 항상 그러한 세부적인 사항을 파고들게 됩니다.

애초에 왜 운영체제 개발을 배워야 하는지 궁금할 겁니다. 나에게 있어서 주요한 이유는 내가 항상 어떻게 일이 돌아가는지에 관심이 있었기 때문입니다. 단순히 호기심만이 아닙니다. 여러분이 하고 있는 일이 더 어려울수록, 종종 운영 체제 수준까지 추적하기 시작합니다. 모든 것이 어떻게 낮은 수준에서 작동하는지 이해하지 못한다면, 당신은 완전히 정보에 입각한 결정을 내릴 수 없습니다. 또 다른 것은, 만약 여러분이 정말로 기술적 도전을 좋아한다면, OS 개발로 일하는 것은 여러분에게 신나는 일이 될 수 있다는 것입니다.

다음 질문은 "왜 리눅스를 사용하는가?" 입니다. 다른 운영체제는 아마도 접근하기가 더 쉬울 것입니다. 정답은 적어도 어떤 면에서는 현재 내가 하고 있는 일이 미래에 할 것으로 예상되는 일에 내 지식이 관련되기를 바란다는 것이다. 이 점에서 리눅스는 완벽합니다. 왜냐하면 요즘은 작은 IoT 장치에서부터 큰 서버에 이르기까지 모든 것이 리눅스를 실행하는 경향이 있기 때문입니다.

내가 리눅스 커널 개발에 관한 대부분의 책들이 나에게 좋지 않았다고 말했을 때 - 나는 꽤 정직하지 못했습니다. OS 개발의 초보자임에도 불구하고 충분히 이해할 수 있는 실제 소스 코드를 이용해 몇 가지 본질적인 개념을 설명한 책이 있었습니다. 이 책은 "Linux Device Drivers"이며 리눅스 커널에 관한 가장 유명한 기술 서적 중 하나라는 것은 놀랄 일이 아닙니다. 그것은 당신이 컴파일하고 가지고 놀 수 있는 간단한 드라이버의 소스 코드를 도입하는 것으로 시작됩니다. 그런 다음 새로운 드라이버 관련 개념을 하나씩 소개하기 시작하고 이러한 새로운 개념을 사용하기 위해 드라이버의 소스 코드를 수정하는 방법을 설명합니다. 그것이 바로 내가 "좋은 학습 경험"이라고 부르는 것입니다. 이 책의 유일한 문제는 드라이버 개발에 초점을 맞추고 있으며 핵심 커널 구현 세부사항에 대해서는 거의 언급하지 않는다는 점입니다.

하지만 왜 아무도 커널 개발자들에 대해서도 비슷한 책을 만들지 않았는가? 나는 너의 경험을 위한 기본으로서 리눅스 커널 소스 코드를 사용하기 때문이라고 생각합니다. 그때에 이것은 가능하지 않습니다. 리눅스 소스에 대해서는 간단한 것이 없기 때문에 단순한 시작점으로 사용할 수 있는 함수나 구조나 모듈이 없습니다. 또한 소스 코드에서는 모든 것이 서로 매우 밀집하게 연관되어 있기 때문에 새로운 개념을 한 번에 하나씩 소개할 수도 없습니다. 이것을 깨달은 이후, 리눅스 커널이 너무 방대하고 복잡해서 OS 개발을 위한 출발점으로 이용될 수 없다면, 학습 목적을 위해 명시적으로 설계될 나만의 OS를 구현하는 것이 어떨까하는 생각이 떠올랐습니다. 이렇게 하면 OS를 충분히 간단하게 만들어 좋은 학습 경험을 제공할 수 있다고 생각합니다. 또한, 만약 이 OS가 리눅스 커널 소스의 다른 부분을 복사하고 단순화함으로써 대부분 구현된다면, 이를 리눅스 커널을 배우는 출발점으로 사용하는 것은 매우 쉬울 것입니다. OS 외에도 주요 OS 개발 개념을 가르치고 OS 소스 코드를 충분히 설명하는 강의 시리즈를 쓰기호 했습니다.

### OS 요건

나는 나중에 [RPi OS](https://github.com/s-matyukevich/raspberry-pi-os)가 될 프로젝트를 시작했습니다. 내가 가장 먼저 해야 할 일은 내가 "기본적"으로 간주하는 커널 개발의 어떤 부분, 그리고 내가 그렇게 본질적이지 않고 생략할 수 있다고 간주하는 요소들을 결정하는 것이었습니다(적어도 초기에는). 내가 알기로는, 각 운영체제는 다음의 두 가지 기본 목표를 가지고 있습니다.

이제 내가 무시하고 싶은 것들을 살펴봅시다.
1. **성능** 나는 OS에서 어떤 정교한 알고리즘도 사용하지 싶지 않습니다. 또한 단순함을 위해 모든 캐시와 다른 성능 최적화 기법들을 비활성화할 것입니다.
1. **보안** RPi OS에는 최소한 하나의 보안 기능인 가상 메모리가 있는 것은 맞습니다. 다른 모든 것은 안전하게 무시될 수 있습니다.
1. **멀티프로세싱과 동기화** 나는 나의 OS가 단일 프로세서 커아에 실행되어 매우 기쁩니다. 특히 이것은 나에게 엄청난 복잡성의 원천인 동기화의 문제를 없앨 수 있게 해줍니다.
1. **다양한 아키텍쳐들과 다른 유형의 디바이스들에 대한 지원** 다음 섹션에서 자세한 내용을 참조하세요.
1. **프로젝트 지원 운영체제가지원하는 수백만 가지의 특징**


### 라즈베리 파이가 어떻게 작동하게 되었는가

나는 이미 RPi OS가 여러 개의 컴퓨터 아키텍쳐나 많은 다른 디바이스들을 지원하지 않기를 바란다고 말했습니다. 리눅스 커널 드라이버 모델을 파고들자 나는 이것에 대해 더욱 강하게 느꼈습니다. 유사한 목적을 가진 장치도 구현 세부사항에 따라 크게 달라질 수 있습니다. 이것은 다양한 드라이버 유형을 중심으로 간단한 추상화를 고안하는 것과 드라이버 소스 코드를 재사용하는 것을 매우 어렵게 만듭니다. 이것이 리눅스 커널의 복잡성의 주요 원인 중 하나처럼 보이며, 나는 반드시 RPi OS에서 그것을 피하고 싶습니다. 그런데 그땐 어떤 컴퓨터를 써야하는가? 나는 내 작업용 노트북을 사용하여 베어메탈 프로그램을 테스트하고 싶지는 않습니다. 왜냐하면 솔직히 말해서 그것이 살아남을 수 있을지 확실할 수 없기 때문입니다. 더 중요한 것은, 나는 사람들이 내 OS 개발 연습에 따르려고 비싼 노트북을 구입하는 것을 원하지 않는다고 생각합니다(어쨋든 아무도 이것을 하지 않을 것이라고 생각합니다). 에뮬레이터는 좋은 선택으로 보이지만, 베어 메탈 프로그래밍을 하기보다는 내가 뭔가 실제적인 일을 하고 있는다는 느낌을 주기 때문에 실제적인 디바이스로 작업하고 싶습니다.

나는 끝내 라즈베리 파이, 특히 [라즈베리 파이3 모델 B](https://www.raspberrypi.org/products/raspberry-pi-3-model-b/).를 사용하게 되었습니다. 이 장치를 사용하는 것은 여러가지로 이상적인 선택으로 보입니다.

1. 이것은 약 35달러가 듭니다. 나는 이것이 적당한 가격이여야한다고 생각합니다.
1. 이 장치는 트겹ㄹ히 학습용으로 설계되었습니다. 그것의 내부 구조는 가능한 한 간단하고, 그것은 나의 요구에 완벽하게 부합합니다.
1. 이 장치는 ARM v8 아키텍쳐를 사용합니다. 이것은 단순한 RISC 아키텍쳐로서 OS 작성자들의 요구에 매우 잘 적응하고 있으며, 예를 들어 인기 있는 x86 아키텍처처럼 많은 레거시 요구사항을 가지고 있지 않습니다. 내 말을 믿기지 않으면 리눅스 커널의 /arch/arm64 및 /arch/x86 폴더에 있는 소스 코드의 양을 비교할 수 있습니다.

이 OS는 라즈베리 파이의 이전 버전과 호환되지 않는데, 그 중 어느 것도 64비트 ARM V8 아키텍처를 지원하지 않기 때문입니다. 그러나 나는 미래의 모든 디바이스에 대한 지원은 사소하다고 생각합니다.

### 커뮤니티와 함께 작업하기

어떤 기술서적의 가장 큰 단점은 발매 직후 각 책이 쓸모 없게 된다는 것입니다. 오늘날 기술은 너무 빨리 진화하고 있어서 책 작가들이 그것을 따라가는 것은 거의 불가능합니다. 그래서 나는 인터넷에서 자유롭게 구할 수 있고 독자들이 콘텐츠 생성과 검증에 참여하도록 장려하는 책인 "오픈 소스 북"이라는 아이디어를 좋아합니다. 만약 책 내용이 깃헙에서 이용 가능하다면, 어떤 독자도 새로운 코드 샘플을 수정하고 개발하며, 책 내용을 업데이트하고, 새로운 장을 쓰는 데 참여하기가 매우 쉽습니다.나는 지금 이 프로젝트가 완벽하지 않다는 것을 이해합니다. 그리고 그 프로젝트를 쓸 당시에는 심지어 완성되지도 않았습니다. 그러나 나는 여전히 그것을 지금 출판하고 싶습니다. 왜냐하면 나는 공동체의 도움으로 그 프로젝트를 더 빨리 완성할 수 있을 뿐만 아니라 처음부터 그랬던 것보다 훨씬 더 좋고 더 유용하게 만들 수 있기를 희망하기 때문입니다.

##### 이전 페이지

[Main Page](https://github.com/s-matyukevich/raspberry-pi-os#learning-operating-system-development-using-linux-kernel-and-raspberry-pi)

##### 다음 페이지

[Prerequisites](../docs/Prerequisites.md)

##### 추가 사항
이 문서는 훌륭한 오픈소스 운영체제 학습 프로젝트인 Sergey Matyukevich의 문서를 영어에 능숙하지 않는 한국인들이 학습할 수 있도록 번역한 것입니다. 오타 및 오역이 있을 수 있습니다. Sergey Matyukevich는 한국어를 능숙하게 다루지 못합니다. 대신 저에게 elxm6123@gmail.com으로 연락주세요.
